---
title: "Happy Git and GitHub for the useR"
output: html_notebook
---

# Introduce yourself to Git

- substituting your name and the email associated with your GitHub account.

```
git config --global user.name "YangPing"
git config --global user.email "yangping1113@icloud.com"
git config --global --list
```

```{r}
library(usethis)
use_git_config(user.name = "YangPing", user.email = "yangping1113@icloud.com")
```

- You can check that Git understood what you typed by looking at the output of `git config --global --list`.


# Configure the default name for an initial branch

- set your default initial branch name to main like so, in the shell:
`git config --global init.defaultBranch main` or from R (the default for name is "main"):
```{r}
usethis::git_default_branch_configure()
```

---

# Basic shell commands

- `pwd`(print working directory) Shows directory or “folder” you are currently operating in. This is not necessarily the same as the R working directory you get from getwd().

- `ls`(list files). Shows the files in the current working directory. This is equivalent to looking at the files in your Finder/Explorer/File Manager. Use `ls -a` to also list hidden files, such as `.Rhistory` and `.git`.

- `cd` (change directory). Allows you to navigate through your directories by changing the shell’s working directory. You can navigate like so:
  - go to subdirectory foo of current working directory: cd foo
  - go to parent of current working directory: `cd ..`
  - go to your “home” directory: `cd ~` or simply `cd`
  - go to directory using absolute path, works regardless of your current working directory: `cd /home/my_username/Desktop`.

---

# A few Git commands:

- `git status` is the most used git command and informs you of your current branch, any changes or untracked files, and whether you are in sync with your remotes.
- `git remote -v` lists all remotes. Very useful for making sure git knows about your remote and that the remote address is correct.
- `git remote add origin GITHUB_URL` adds the remote GITHUB_URL with nickname origin.
- `git remote set-url origin GITHUB_URL` changes the remote url of origin to GITHUB_URL. This way you can fix typos in the remote url.

---

# Generate token

Go to https://github.com/settings/tokens and click “Generate token”.
Or, from R, do:
```{r}
usethis::create_github_token()
```
Look over the scopes; I highly recommend selecting “repo”, “user”, and “workflow”.

You could even get out ahead of this and store the PAT explicitly right now. In R, call gitcreds::gitcreds_set() to get a prompt where you can paste your PAT:
```{r}
gitcreds::gitcreds_set()
```

---

# PAT
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

Changing a specific remote from HTTPS to SSH (and back again) is a straightforward operation with git remote set-url REMOTE_NAME DESIRED_URL:
```
~/rrr/happy-git-with-r % git remote -v
origin  https://github.com/jennybc/happy-git-with-r.git (fetch)
origin  https://github.com/jennybc/happy-git-with-r.git (push)

~/rrr/happy-git-with-r % git remote set-url origin git@github.com:jennybc/happy-git-with-r.git

~/rrr/happy-git-with-r % git remote -v
origin  git@github.com:jennybc/happy-git-with-r.git (fetch)
origin  git@github.com:jennybc/happy-git-with-r.git (push)

~/rrr/happy-git-with-r % git remote set-url origin https://github.com/jennybc/happy-git-with-r.git
```
We can do the same from R using functions in usethis:
```{r}
usethis::git_remotes()
#> $origin
#> [1] "https://github.com/jennybc/happy-git-with-r.git"

usethis::use_git_remote(
  "origin",
  "git@github.com:jennybc/happy-git-with-r.git",
  overwrite = TRUE
)

usethis::git_remotes()
#> $origin
#> [1] "git@github.com:jennybc/happy-git-with-r.git"

usethis::use_git_remote(
  "origin",
  "https://github.com/jennybc/happy-git-with-r.git",
  overwrite = TRUE
)
```

---

# Clone the repo to your local computer

Take charge of – or at least notice! – what directory you’re in. `pwd` displays the working directory. `cd` is the command to change directory. Personally, I would do this sort of thing in ~/tmp.

Clone myrepo from GitHub to your computer. Use the URL we just copied from GitHub. This URL should have **your GitHub username** and the name of your **practice repo**. If your shell (Appendix A) cooperates, you should be able to paste the whole https://.... bit that we copied above. But some shells are not (immediately) clipboard aware. In that sad case, you must type it. **Accurately**.
```
git clone https://github.com/YOUR-USERNAME/YOUR-REPOSITORY.git
```

Make this new repo your working directory, list its files, display the README, and get some information on its connection to GitHub:
```
cd myrepo
ls
head README.md
git remote show origin
```


`pwd` displays the working directory. `cd` is the command to change directory. Personally, I would do this sort of thing in `~/tmp`.

```
~/tmp % cd myrepo

~/tmp/myrepo % ls
README.md

~/tmp/myrepo % head README.md 
# myrepo
checking stuff for Happy Git

~/tmp/myrepo % git remote show origin
* remote origin
  Fetch URL: https://github.com/jennybc/myrepo.git
  Push  URL: https://github.com/jennybc/myrepo.git
  HEAD branch: main
  Remote branch:
    main tracked
  Local branch configured for 'git pull':
    main merges with remote main
  Local ref configured for 'git push':
    main pushes to main (up to date)
```


#  Make a local change, commit, and push

```
~/tmp/myrepo % echo "A line I wrote on my local computer" >> README.md

~/tmp/myrepo % git status
```

If you already stored your PAT with `gitcreds::gitcreds_set()`, it should be discovered automatically and you will not see a credential challenge.
```
git add README.md
git commit -m "A commit from my local computer"
git push
```

---

# Clean up

Here’s how to do that in the shell, if current working directory is myrepo:
```
cd ..
rm -rf myrepo/
```

---

# Connect RStudio to Git and GitHub

Clone the test GitHub repository to your computer via RStudio
In RStudio, start a new Project:

- *File > New Project > Version Control > Git.* In “Repository URL”, paste the URL of your new GitHub repository. It will be something like this `https://github.com/jennybc/myrepo.git.`

  - Do you NOT see an option to get the Project from Version Control? Restart RStudio and try again. Still no luck? Go to chapter 13 for tips on how to help RStudio find Git.

- Accept the default project directory name, e.g. myrepo, which coincides with the GitHub repo name.

- Take charge of – or at least notice! – where the Project will be saved locally. A common rookie mistake is to have no idea where you are saving files or what your working directory is. Pay attention. Be intentional. Personally, I would do this in `~/tmp`.

- I suggest you check “Open in new session”, as that’s what you’ll usually do in real life.

- Click “Create Project”.

You should find yourself in a new local RStudio Project that represents your test repo on GitHub. This should download the README.md file from GitHub. Look in RStudio’s file browser pane for the `README.md` file.

---

# Make local changes, save, commit.  

From RStudio, modify the README.md file, e.g., by adding the line “This is a line from RStudio”. Save your changes.

Commit these changes to your local repo. How?
From RStudio:
- Click the “Git” tab in upper right pane.
- Check “Staged” box for README.md.
- If you’re not already in the Git pop-up, click “Commit”.
- Type a message in “Commit message”, such as “Commit from RStudio”.
- Click “Commit”.

# Push your local changes online to GitHub
Click the green “Push” button to send your local changes to GitHub.




